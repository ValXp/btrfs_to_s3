# Progress: btrfs_to_s3 main tool

## Status
- 2026-01-17 10:41 MST: Designed main tool architecture and updated plans/tasks; commit "Add main tool design and update plans".
- 2026-01-17 10:48 MST: Finalized spooling decision (SSD 200 GiB) and updated design/plan/tasks.
- 2026-01-17 10:49 MST: Set test storage default to STANDARD and updated plans.
- 2026-01-17 10:51 MST: Added multipart policy and expanded agent-ready task breakdown.
- 2026-01-17 10:54 MST: Expanded task acceptance criteria and test requirements.
- 2026-01-17 10:56 MST: Added default Codex args to bypass approvals/sandbox.
- 2026-01-17 10:58 MST: Removed unsupported --non-interactive from default Codex args.
- 2026-01-17 10:59 MST: Pass non-interactive flag via positional args in work loop.
- 2026-01-17 11:00 MST: Switch Codex work loop to use non-interactive exec subcommand.
- 2026-01-17 11:01 MST: Adjusted work loop to pass prompt positionally for codex exec.
- 2026-01-17 11:09 MST: Documented Python3 runtime and test completion gate.
- 2026-01-17 11:13 MST: Added Task 0 for repository scaffolding and test setup.
- 2026-01-17 11:22 MST: Completed Task 0 scaffolding; commit "Add initial package scaffolding".
- 2026-01-17 11:23 MST: Removed pycache artifacts and ignored bytecode; commit "Ignore Python bytecode".
- 2026-01-17 11:27 MST: Completed Task 1 config/CLI/logging with tests; commit "Implement config and CLI".
- 2026-01-17 11:29 MST: Completed Task 2 lock/state storage with tests; commit "Add lock and state modules".
- 2026-01-17 11:30 MST: Completed Task 3 snapshot manager with retention tests; commit "Add snapshot manager".
- 2026-01-17 11:32 MST: Completed Task 4 planner cadence/fallback with tests; commit "Add backup planner".
- 2026-01-17 11:34 MST: Completed Task 5 chunker/streamer with tests; commit "Add stream chunker".
- 2026-01-17 11:36 MST: Completed Task 6 S3 uploader with retries and tests; commit "Add S3 uploader".
- 2026-01-17 11:37 MST: Completed Task 7 manifest/current publish with tests; commit "Add manifest publisher".
- 2026-01-17 11:38 MST: Completed Task 8 metrics calculations with tests; commit "Add metrics module".
- 2026-01-17 11:39 MST: Completed Task 9 systemd units and docs; commit "Add systemd units".
- 2026-01-17 11:40 MST: Blocked on Task 10 integration harness; missing AWS test bucket/prefix credentials. Commit "Add stop marker".
- 2026-01-17 14:29 MST: Updated test harness config to use python3 and new test bucket/prefix.
- 2026-01-17 14:32 MST: Added losetup in PATH
- 2026-01-17 15:05 MST: Completed Task 10 integration harness run and aligned harness/CLI; commit "Complete integration harness run".
- 2026-01-17 15:12 MST: Added restore + multi-chunk requirements and tasks (post-completion).
- Next: implement Task 12 restore verification and Task 13 integration harness with restore + multi-chunk.
- 2026-01-17 16:31 MST: Completed Task 11 restore core with manifest resolution and restore tests; commit "Implement restore core".
- 2026-01-17 16:38 MST: Completed Task 12 restore verification; commit "Add restore verification".
- 2026-01-17 16:49 MST: Blocked on Task 13 harness run (setup_btrfs losetup permission failure); commit "Record Task 13 harness block".
- 2026-01-17 17:09 MST: Completed Task 13 integration harness (restore + multi-chunk); commit "Complete Task 13 harness run".
- 2026-01-17 17:25 MST: Added follow-up tasks to address review findings (streamed chunking, schedule/lock integration, restore streaming, verification fallback, concurrency/spool). Next: start Task 1 in tasks.md.

- 2026-01-17 17:28 MST: Completed Task 1 streamed chunking + multipart limits; commit "Stream chunks and cap multipart parts".
- 2026-01-17 17:31 MST: Completed Task 2 restore streaming; commit "Stream restore downloads".
- 2026-01-17 17:36 MST: Completed Task 3 planner + schedule integration; commit "Integrate planner with CLI schedule".
- 2026-01-17 17:39 MST: Completed Task 4 lock during backups; commit "Lock backups in CLI".
- 2026-01-17 17:42 MST: Completed Task 5 missing parent fallback; commit "Fallback to full when parent missing".
- 2026-01-17 17:43 MST: Completed Task 6 restore verification without local snapshot; commit "Allow restore verification without source".
- 2026-01-17 17:51 MST: Completed Task 7 upload concurrency and spooling; commit "Add upload concurrency and spooling".
- 2026-01-17 18:02 MST: Added Task 8 (stale lock recovery) and Task 9 (incremental manifest parent validation) to address high-priority review findings.
- 2026-01-17 18:07 MST: Completed Task 9 incremental manifest parent validation; commit "Validate manifest parents for incrementals".
- 2026-01-17 18:10 MST: Completed Task 8 stale lock recovery tests; commit "Test stale lock recovery in CLI".
- 2026-01-18 15:43 MST: Completed Task 10 log throughput metrics; commit "Log backup and restore metrics".
- 2026-01-18 15:46 MST: Completed Task 11 config documentation; commit "Document config parameters".
- 2026-01-19 20:09 MST: Completed Task 12 backup upload failure cleanup; commit "Handle btrfs send cleanup on upload failure".
- 2026-01-19 20:11 MST: Completed Task 13 restore error cleanup; commit "Cleanup btrfs receive on restore failure".
- 2026-01-19 20:13 MST: Completed Task 14 shared sbin PATH helper; commit "Share sbin PATH helper".
- 2026-01-19 20:15 MST: Completed Task 15 seekless upload stream handling; commit "Handle non-seekable put_object streams".
- 2026-01-19 21:02 MST: Completed Task 16 orchestration refactor; commit "Extract backup orchestration classes".
- 2026-01-19 21:27 MST: Completed Task 17 CLI coverage uplift; commit "Increase CLI coverage".
- 2026-01-19 22:16 MST: Completed Task 18 config coverage uplift; commit "Increase config coverage".
- 2026-01-19 22:17 MST: Completed Task 19 lock coverage uplift; commit "Increase lock coverage".

- 2026-01-19 22:23 MST: Completed Task 20 orchestrator coverage uplift; commit "Increase orchestrator coverage".
- 2026-01-19 22:29 MST: Completed Task 21 restore coverage uplift; commit "Increase restore coverage".
